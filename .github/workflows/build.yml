- name: Build Plugins
  run: |
    cd $GITHUB_WORKSPACE/src
    chmod +x gradlew
    ./gradlew make

    mkdir -p $GITHUB_WORKSPACE/builds

    # cs3 dosyalarını kopyala
    find . -type f -name "*.cs3" -exec cp {} $GITHUB_WORKSPACE/builds \;

    cd $GITHUB_WORKSPACE/builds

    # plugins.json oluştur
    echo "[" > plugins.json

    first=true
    for file in *.cs3; do
      if [ "$first" = true ]; then
        first=false
      else
        echo "," >> plugins.json
      fi

      echo "  {" >> plugins.json
      echo "    \"name\": \"${file%.cs3}\"," >> plugins.json
      echo "    \"url\": \"https://raw.githubusercontent.com/${{ github.repository }}/builds/$file\"" >> plugins.json
      echo -n "  }" >> plugins.json
    done

    echo "" >> plugins.json
    echo "]" >> plugins.json
